<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœƒå“¡ä¸­å¿ƒ - Vieshow Ticketing</title>

    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Libre+Barcode+128&display=swap" rel="stylesheet">

    <style>
        /* è‡ªå®šç¾©æ¨£å¼ */
        .btn-action {
            /* è®“æ–¹å¡Šè®Šå¤§ï¼šå¢åŠ  padding */
            display: flex;
            flex-direction: column; /* è®“åœ–æ¨™å’Œæ–‡å­—ä¸Šä¸‹æ’åˆ— */
            align-items: center;
            justify-content: center;
            padding: 1.5rem 1rem;
            height: 100%; /* ç¢ºä¿ç¶²æ ¼ä¸­çš„æ¯å€‹é …ç›®ç­‰é«˜ */
            border-radius: 0.5rem;
            font-weight: 700;
            transition: all 0.2s ease-in-out;
            text-align: center;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
            border: 1px solid transparent;
        }
        .btn-action span.icon {
            font-size: 1.5rem; /* å¢å¤§åœ–æ¨™ */
            margin-bottom: 0.5rem;
        }
        .btn-action:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        /* èª¿æ•´ç™»å‡ºæŒ‰éˆ• */
        .btn-logout-action {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 700;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
        }
        .btn-logout-action:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        /* æ–°å¢é€šçŸ¥å‹•ç•« */
        @keyframes fadeInDown {
            from { opacity: 0; transform: translate(-50%, -20px); }
            to { opacity: 1; transform: translate(-50%, 0); }
        }
        @keyframes fadeOutUp {
            from { opacity: 1; transform: translate(-50%, 0); }
            to { opacity: 0; transform: translate(-50%, -20px); }
        }
        .animate-fade-in-down { animation: fadeInDown 0.5s ease-out forwards; }
        .animate-fade-out-up { animation: fadeOutUp 0.5s ease-in forwards; }

        /* æ¢ç¢¼å®¹å™¨å’Œé¡¯ç¤ºèª¿æ•´ (ç¢ºä¿èˆ‡åŠŸèƒ½æ–¹å¡Šè¦–è¦ºæ¯”ä¾‹ä¸€è‡´) */
        .barcode-container {
            /* è¨­ç½®å›ºå®šé«˜åº¦ï¼Œä½¿å…¶çœ‹èµ·ä¾†èˆ‡åŠŸèƒ½æŒ‰éˆ•çš„è¦–è¦ºé«˜åº¦ç›¸ä¼¼ */
            height: 10rem; 
            display: flex;
            align-items: center; /* è®“æ¢ç¢¼å‚ç›´ç½®ä¸­ */
            justify-content: center;
            border: 1px solid #ccc; /* å¢åŠ é‚Šæ¡†è®“å…¶çœ‹èµ·ä¾†æ›´åƒä¸€å€‹ç¨ç«‹æ–¹å¡Š */
            border-radius: 0.5rem;
            padding: 10px;
            background-color: white;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }
        .barcode-display {
            font-family: 'Libre Barcode 128', monospace;
            font-size: 80px; /* å¢å¤§æ¢ç¢¼æœ¬èº«ï¼Œå¡«æ»¿å®¹å™¨ */
            text-align: center;
            line-height: 1;
            display: block;
            margin: 0 auto;
            max-width: 100%;
            overflow-x: hidden;
        }
    </style>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'vieshow-red': '#e50914',
                        'vieshow-gold': '#f7a83d',
                        'btn-primary': '#4f46e5',
                        'btn-hover': '#4338ca',
                        'btn-danger': '#ef4444',
                    },
                    fontFamily: {
                        sans: ['Inter', 'Noto Sans TC', 'sans-serif'],
                    },
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 font-sans min-h-screen flex flex-col">

    <header class="bg-gray-800 text-white shadow-md">
        <nav class="container mx-auto px-4 py-4 flex justify-between items-center">
            <a href="../../index.html" class="text-xl font-bold hover:text-vieshow-red transition duration-300">Vieshow å½±åŸ</a>
            <div id="headerNavRight" class="space-x-4 flex items-center">
                <span class="text-sm font-medium">æ­¡è¿ï¼Œ<span id="memberName"></span></span>
                </div>
            </div>
        </nav>
    </header>

    <div class="container mx-auto px-4 py-10 flex-grow max-w-6xl">

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            
            <div class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-vieshow-gold member-details-container">
                <h1 class="text-3xl font-extrabold text-gray-800 mb-4 flex items-center">
                    <span class="mr-2">ğŸ‘¤</span> æœƒå“¡ä¸­å¿ƒé¦–é  
                    <span class="text-base font-normal ml-3 text-gray-500">(Hi, <span id="memberGreetingName"></span>)</span>
                </h1>

                <div class="space-y-3 text-lg text-gray-700">
                    <h2 class="text-xl font-bold border-b pb-1 mb-2 text-vieshow-red">æœƒå“¡è³‡æ–™:</h2>
                    
                    <p>
                        <span class="font-semibold text-gray-600 w-20 inline-block">å§“å:</span> 
                        <span id="profile_name" class="font-bold"></span>
                    </p>
                    <p>
                        <span class="font-semibold text-gray-600 w-20 inline-block">gmail:</span> 
                        <span id="profile_email"></span>
                    </p>
                    <p>
                        <span class="font-semibold text-gray-600 w-20 inline-block">é›»è©±:</span> 
                        <span id="profile_phone"></span>
                    </p>
                    <p>
                        <span class="font-semibold text-gray-600 w-20 inline-block">ç”Ÿæ—¥:</span> 
                        <span id="profile_dob"></span>
                    </p>
                    <p>
                        <span class="font-semibold text-gray-600 w-20 inline-block">å›é¥‹é»æ•¸:</span> 
                        <span id="profile_points" class="text-vieshow-gold font-bold text-xl"></span>
                        <span class="ml-1 text-sm text-gray-500">é»</span>
                    </p>
                    <p>
                        <span class="font-semibold text-gray-600 w-20 inline-block">æœƒå“¡ç·¨è™Ÿ:</span> 
                        <span id="profile_member_id" class="font-mono tracking-widest"></span>
                    </p>
                    
                    <div class="pt-4">
                        <h3 class="font-semibold mb-1 text-gray-600">æœƒå“¡æ¢ç¢¼:</h3>
                        <div id="barcodeContainer" class="barcode-container">
                            <span id="barcodeValue" class="barcode-display"></span>
                        </div>
                    </div>
                </div>
            </div>

            <div>
                <h2 class="text-2xl font-bold text-gray-700 mb-4 border-l-4 border-vieshow-red pl-3">å¿«é€ŸåŠŸèƒ½å°è¦½</h2>

                <div class="member-actions grid grid-cols-2 gap-4">

                    <a href="../../index.html" class="btn-action bg-white text-gray-700 border-gray-300 hover:bg-gray-100">
                        <span class="icon" role="img" aria-label="Home">ğŸ </span> é¦–é 
                    </a>

                    <a href="../booking/booking_flow_1.html" class="btn-action bg-vieshow-red text-white hover:bg-red-700">
                        <span class="icon" role="img" aria-label="Ticket">ğŸ«</span> ç«‹å³è¨‚ç¥¨
                    </a>

                    <a href="../booking/booking_history.html" class="btn-action bg-white text-gray-700 border-gray-300 hover:bg-gray-100">
                        <span class="icon" role="img" aria-label="History">ğŸ§¾</span> è¨‚ç¥¨ç´€éŒ„
                    </a>

                    <a href="../points/point_exchange.html" class="btn-action bg-white text-gray-700 border-gray-300 hover:bg-gray-100">
                        <span class="icon" role="img" aria-label="Coin">ğŸª™</span> é»æ•¸å…Œæ›
                    </a>

                    <a href="./topup.html" class="btn-action bg-white text-gray-700 border-gray-300 hover:bg-gray-100">
                        <span class="icon" role="img" aria-label="Card">ğŸ’³</span> é»æ•¸å„²å€¼
                    </a>

                    <a href="./member_profile.html" class="btn-action bg-white text-gray-700 border-gray-300 hover:bg-gray-100">
                        <span class="icon" role="img" aria-label="Settings">âš™ï¸</span> æœƒå“¡è³‡æ–™ä¿®æ”¹
                    </a>
                </div>
                
                <button id="signOutButton" class="btn-logout-action bg-btn-danger text-white hover:bg-red-600 mt-6 w-full"> 
                    <span class="mr-2 text-xl">â¡ï¸</span> ç™»å‡º
                </button>
            </div>

        </div>

    </div>

    <footer class="bg-gray-800 text-white text-center py-4 mt-8 shadow-inner">
        <p>&copy; 2025 Vieshow Ticketing System</p>
    </footer>

    <script>
        const LOGIN_PAGE_URL = '../auth/login.html';
        const INDEX_PAGE_URL = '../../index.html';

        /**
         * æ¨¡æ“¬è³‡æ–™åº«ç²å–çš„æœƒå“¡è³‡æ–™ (è™›æ“¬è³‡æ–™åº«)
         */
        const MEMBER_DATA = {
            name: "ç‹å¤§æ˜",
            email: "david.wang@vieshow.tw",
            phone: "0912 345 678",
            dob: "1998/10/25",
            points: "20,000",
            memberId: "1234567890", // 10 ä½æ•¸
            barcodeContent: "1234567890" // æ¢ç¢¼ç·¨ç¢¼å…§å®¹
        };


        /**
         * çµ±ä¸€çš„é€šçŸ¥é¡¯ç¤ºå‡½æ•¸
         */
        function showNotification(message, isError = false) {
            const notification = document.createElement('div');
            notification.innerHTML = message;
            const bgColor = isError ? 'bg-red-100 text-red-800' : 'bg-green-100 text-green-800';
            
            notification.className = `fixed top-0 left-1/2 -translate-x-1/2 mt-4 px-6 py-3 rounded-lg shadow-xl z-50 transition duration-300 transform ${bgColor} animate-fade-in-down`;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.replace('animate-fade-in-down', 'animate-fade-out-up');
                setTimeout(() => notification.remove(), 500);
            }, 3000);
        }

        /**
         * æª¢æŸ¥ç™»å…¥ç‹€æ…‹ï¼šå¦‚æœæ²’æœ‰ Token å‰‡è·³è½‰åˆ°ç™»å…¥é ã€‚
         */
        function checkLoginStatus() {
            const token = localStorage.getItem('auth_token');
            if (!token) {
                window.location.href = LOGIN_PAGE_URL; 
                document.body.innerHTML = '<p class="text-center text-xl p-10">æ‚¨å°šæœªç™»å…¥ï¼Œæ­£åœ¨å°å‘ç™»å…¥é é¢...</p>';
                return false;
            }
            return true;
        }
        
        /**
         * æ¸²æŸ“æœƒå“¡è³‡æ–™åˆ°é é¢ (æ¨¡æ“¬å¾è³‡æ–™åº«è®€å–å¾Œæ¸²æŸ“)
         */
        function renderMemberData() {
            // Header æ­¡è¿èª
            document.getElementById('memberName').textContent = MEMBER_DATA.name;
            document.getElementById('memberGreetingName').textContent = MEMBER_DATA.name;

            // æœƒå“¡è©³ç´°è³‡æ–™
            document.getElementById('profile_name').textContent = MEMBER_DATA.name;
            document.getElementById('profile_email').textContent = MEMBER_DATA.email;
            document.getElementById('profile_phone').textContent = MEMBER_DATA.phone;
            document.getElementById('profile_dob').textContent = MEMBER_DATA.dob;
            document.getElementById('profile_points').textContent = MEMBER_DATA.points;
            document.getElementById('profile_member_id').textContent = MEMBER_DATA.memberId;
            
            // æ¢ç¢¼å…§å®¹
            document.getElementById('barcodeValue').textContent = MEMBER_DATA.barcodeContent;
        }


        // --- ç™»å‡ºè™•ç† (ä¸æ›´æ”¹é‚è¼¯) ---
        document.getElementById('signOutButton').addEventListener('click', function(e) {
            e.preventDefault(); 

            // ç¦ç”¨æŒ‰éˆ•ä»¥é˜²æ­¢é‡è¤‡é»æ“Š
            this.disabled = true; 
            this.textContent = 'ç™»å‡ºä¸­...';

            // 1. æ¸…é™¤ç™»å…¥ç‹€æ…‹çš„é—œéµæ­¥é©Ÿ
            localStorage.removeItem('auth_token'); 

            // 2. é¡¯ç¤ºç™»å‡ºè¨Šæ¯ (ä½¿ç”¨å½ˆè·³æ¡†)
            showNotification('âœ… ç™»å‡ºæˆåŠŸï¼å³å°‡å°å‘é¦–é ...', false);

            // 3. æ›¿æ› Header å°èˆªç‚ºæœªç™»å…¥ç‹€æ…‹ (è¦–è¦ºæ›´æ–°)
            const headerNavRight = document.getElementById('headerNavRight');
            if (headerNavRight) {
                headerNavRight.innerHTML = `
                    <a href="${LOGIN_PAGE_URL}" class="hover:text-vieshow-gold transition duration-300">ç™»å…¥</a>
                    <a href="../auth/register.html" class="hover:text-vieshow-gold transition duration-300">è¨»å†Š</a>
                `;
            }

            // 4. å»¶é² 2 ç§’å¾Œå°å‘é¦–é 
            setTimeout(() => {
                window.location.href = INDEX_PAGE_URL; 
            }, 2000);
        });

        // é é¢è¼‰å…¥æ™‚åŸ·è¡Œæª¢æŸ¥èˆ‡è³‡æ–™æ¸²æŸ“
        window.onload = function() {
            if (!checkLoginStatus()) {
                return; 
            }
            renderMemberData(); // æ¸²æŸ“æ¨¡æ“¬çš„æœƒå“¡è³‡æ–™
            console.log("æœƒå“¡ä¸­å¿ƒé é¢åˆå§‹åŒ–å®Œæˆï¼Œè™›æ“¬è³‡æ–™å·²è¼‰å…¥ã€‚");
        };
    </script>

</body>
</html>
